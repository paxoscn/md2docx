# 一级标题自动分页功能使用指南

## 快速开始

现在，当你使用 md2docx 转换 Markdown 文件时，所有一级标题（`# 标题`）会自动在新页面开头显示。

### 示例

创建一个 Markdown 文件 `document.md`：

```markdown
# 第一章：引言

这是第一章的内容。

## 1.1 背景

这是背景部分。

# 第二章：方法

这是第二章的内容。这个标题会自动出现在新的一页。

## 2.1 研究设计

这是研究设计部分。

# 第三章：结果

这是第三章的内容。这个标题也会自动出现在新的一页。
```

### 转换命令

```bash
./target/release/md2docx-cli convert --input document.md --output document.docx
```

### 结果

生成的 DOCX 文件中：
- **第一章**：显示在第一页
- **第二章**：显示在新的一页（第二页）
- **第三章**：显示在新的一页（第三页）
- 所有二级标题（##）和更低级别的标题保持在当前页

## 功能特点

### ✅ 自动化
- 无需手动插入分页符
- 无需特殊标记或语法
- 完全自动处理

### ✅ 智能化
- 第一个一级标题不会触发分页（避免空白首页）
- 只对一级标题生效
- 不影响其他级别的标题

### ✅ 兼容性
- 与现有 Markdown 语法完全兼容
- 不需要修改现有文档
- 保持所有其他格式设置

## 适用场景

这个功能特别适合以下类型的文档：

1. **书籍和电子书**
   - 每章从新页面开始
   - 专业的排版效果

2. **学术论文和报告**
   - 清晰的章节划分
   - 符合学术规范

3. **技术文档**
   - 模块化的内容组织
   - 易于导航和阅读

4. **商业文档**
   - 专业的外观
   - 清晰的结构

## 工作原理

### 技术实现

1. **检测一级标题**：当解析器遇到 `# 标题` 时
2. **判断是否为第一个**：检查是否是文档中的第一个一级标题
3. **插入分页符**：如果不是第一个，在标题前插入分页符
4. **继续处理**：正常渲染标题内容

### 状态管理

- 每次生成新文档时重置状态
- 跟踪是否已遇到第一个一级标题
- 确保每个文档独立处理

## 示例文档

项目中包含了以下测试文档供参考：

1. **test_h1_page_break.md** - 基本示例
2. **test_h1_page_break_detailed.md** - 详细示例，包含多个章节
3. **test_first_h1_no_break.md** - 演示第一个标题不分页
4. **test_h1_with_intro.md** - 包含引言的文档

你可以使用这些文件进行测试：

```bash
# 测试基本功能
./target/release/md2docx-cli convert --input test_h1_page_break.md --output output1.docx

# 测试详细文档
./target/release/md2docx-cli convert --input test_h1_page_break_detailed.md --output output2.docx

# 测试第一个标题
./target/release/md2docx-cli convert --input test_first_h1_no_break.md --output output3.docx

# 测试带引言的文档
./target/release/md2docx-cli convert --input test_h1_with_intro.md --output output4.docx
```

## 常见问题

### Q: 如何禁用这个功能？
A: 目前这个功能是默认启用的。如果需要禁用，可以在配置文件中添加相应选项（未来版本将支持）。

### Q: 可以让其他级别的标题也分页吗？
A: 目前只支持一级标题。未来版本可能会添加配置选项来支持其他级别。

### Q: 第一个标题为什么不分页？
A: 为了避免文档第一页为空。如果你希望第一个标题也分页，可以在文档开头添加一些引言内容。

### Q: 可以手动控制某些标题不分页吗？
A: 目前不支持。未来版本可能会添加特殊注释或属性来控制单个标题的分页行为。

## 技术细节

如果你是开发者，想了解更多技术细节，请参考：

- **H1_PAGE_BREAK_FEATURE.md** - 详细的功能说明
- **H1_PAGE_BREAK_SUMMARY.md** - 实现总结
- **src/docx/generator.rs** - 源代码

## 反馈和建议

如果你有任何问题、建议或发现了 bug，欢迎提交 issue 或 pull request。

---

**享受更专业的文档排版体验！** 📄✨
